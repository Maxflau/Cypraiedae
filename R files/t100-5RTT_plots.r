

pdf(file='/Users/max/Desktop/Phylogenetic_cowries/pyrate_mcmc_logs/pyrate_mcmc_logs/t100-5RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-6.65045317396705, -8.12833165707084,-9.606210140174628,-11.084088623278417,-12.561967106382205,-14.039845589485994,-15.517724072589784,-16.995602555693576,-18.473481038797363,-19.951359521901153,-21.42923800500494,-22.90711648810873,-24.38499497121252,-25.862873454316308,-27.340751937420098,-28.818630420523885,-30.296508903627675,-31.774387386731465,-33.25226586983525,-34.73014435293904,-36.20802283604283,-37.685901319146616,-39.1637798022504,-40.6416582853542,-42.119536768457984,-43.59741525156177,-45.075293734665564,-46.55317221776935,-48.03105070087314,-49.50892918397693,-50.98680766708072,-52.464686150184505,-53.9425646332883,-55.420443116392086,-56.89832159949587,-58.37620008259966,-59.85407856570345,-61.33195704880724,-62.80983553191103,-64.28771401501483,-65.76559249811862,-67.2434709812224,-68.7213494643262,-70.19922794742999,-71.67710643053377,-73.15498491363756,-74.63286339674134,-76.11074187984514,-77.58862036294893,-79.06649884605271,-80.5443773291565,-82.0222558122603,-83.50013429536408,-84.97801277846787,-86.45589126157167,-87.93376974467544,-89.41164822777924,-90.88952671088303,-92.36740519398681,-93.8452836770906,-95.3231621601944,-96.80104064329818,-98.27891912640197,-99.75679760950577)
rate=c(0.3136387638548145, 0.06461347601292769,0.06355343706510039,0.06355477370490645,0.0635593230318714,0.0635953804307049,0.0636400250964475,0.06401999925024693,0.1970689190900307,0.19708881778444276,0.19708881778444276,0.19710428400318897,0.1971267508777994,0.19717440108120474,0.19719130523070716,0.19715019127641367,0.19658024119720144,0.1927757073025178,0.17963508020731722,0.09987066971520017,0.09656610525955017,0.09614277973941493,0.09604057600566757,0.09602014423774974,0.09600868682238312,0.09601523038661802,0.09601523038661802,0.09600868682238312,0.09600656688762449,0.095998255500142,0.095998255500142,0.09599554315417297,0.095998255500142,0.09604057600566757,0.0973703128234188,0.09853224503385194,0.10021317302021336,0.10211128437728137,0.12680719769241722,0.22623134877191944,0.2545032266304669,0.2587707768934712,0.2592047663907274,0.25924937853670776,0.2592456544686849,0.2592456544686849,0.25926061936571154,0.25930564574748527,0.2593616649801401,0.25967013506050074,0.26018171456236583,0.2612452067661279,0.2625322279412384,0.26359535903400594,0.2640456311884284,0.26424565040737186,0.2643248537913069,0.2643964013146438,0.26444817176787455,0.2644925416360012,0.264502459114328,0.2645615794992655,0.2646677282588408,0.2648781031850882)
minHPD=c(0.2653850077190521, 0.037176182683436525,0.04507256281591538,0.04507256281591538,0.04514666081791613,0.04516407696130235,0.045640744991027445,0.04330756630510344,0.16702175253824586,0.16697449811253304,0.16697449811253304,0.16697449811253304,0.16691513147505715,0.1672181880269817,0.1670710053495969,0.16697449811253304,0.16199481476850378,0.08946928351820267,0.08097153472726992,0.07231709462264233,0.07140397606044434,0.07370052188170731,0.07414969466450738,0.07415933214275959,0.07414969466450738,0.07384964319438124,0.07387372228204032,0.07384964319438124,0.07387372228204032,0.07387372228204032,0.07374634772577869,0.07374634772577869,0.07414969466450738,0.07373322378324973,0.06720024219461007,0.07086811289197414,0.07220735216477008,0.07220735216477008,0.07773636998605248,0.07803804306443561,0.09568387176735968,0.17809965460011623,0.17682080391882346,0.17682080391882346,0.17580002571663764,0.1761365606088876,0.17627384403831423,0.17682080391882346,0.17682080391882346,0.17762179577530188,0.17682080391882346,0.17682080391882346,0.17682080391882346,0.1764589640188057,0.1778882025174919,0.1764589640188057,0.17682080391882346,0.1761365606088876,0.1778882025174919,0.17682080391882346,0.17515838076299714,0.17236901802246007,0.16965724933429194,0.1721823203882387)
maxHPD=c(0.3620524040359775, 0.286628709244958,0.08374868841371295,0.0837224570149328,0.0837224570149328,0.0837224570149328,0.08444275402514478,0.08858452585162323,0.22867601673207846,0.2282313261072289,0.2282313261072289,0.2282313261072289,0.22824370870746713,0.22867601673207846,0.22863359792589827,0.22944659350055427,0.23482371049579887,0.2265422063963767,0.2213874170504432,0.20320677660839234,0.12343302554225867,0.11988097629426162,0.119133847691277,0.1190802797820839,0.11903298543866415,0.11871241251502715,0.11871241251502715,0.11864783125988634,0.11871241251502715,0.11871241251502715,0.11864783125988634,0.11864783125988634,0.119133847691277,0.1192193480336202,0.1822350281920281,0.2199025263615992,0.2413946933021552,0.25460758762916247,0.2979344408787496,0.3137832032771485,0.3387669188582215,0.3561760710243311,0.348972063064157,0.3486819618527091,0.3473616856711023,0.3474334827382414,0.3474334827382414,0.3474334827382414,0.34730265234183244,0.3473616856711023,0.34673266415000964,0.3514244710757491,0.35768904435633214,0.36384751801874865,0.3695750789537414,0.36982152529434426,0.37095237754963284,0.37095237754963284,0.37402026622143947,0.37402026622143947,0.37485599814134374,0.37402026622143947,0.37698746743612876,0.38888066256710674)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 0.42776872882381745), xlim = c(-100.0,-5.3), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (Phylogenetic_cowriesV2_1_Grj_se_est_0_rj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-5.778282828282828, -6.734848484848485,-7.691414141414142,-8.647979797979797,-9.604545454545455,-10.56111111111111,-11.517676767676768,-12.474242424242423,-13.430808080808081,-14.387373737373736,-15.343939393939394,-16.300505050505052,-17.257070707070707,-18.213636363636365,-19.17020202020202,-20.126767676767678,-21.083333333333336,-22.03989898989899,-22.99646464646465,-23.953030303030303,-24.90959595959596,-25.866161616161616,-26.822727272727274,-27.779292929292932,-28.735858585858587,-29.692424242424245,-30.6489898989899,-31.605555555555554,-32.56212121212121,-33.51868686868687,-34.47525252525252,-35.43181818181818,-36.38838383838384,-37.344949494949496,-38.30151515151515,-39.258080808080805,-40.214646464646464,-41.17121212121212,-42.12777777777777,-43.08434343434343,-44.04090909090909,-44.99747474747475,-45.954040404040406,-46.91060606060606,-47.867171717171715,-48.82373737373737,-49.78030303030303,-50.73686868686869,-51.69343434343434,-52.65,-53.60656565656566,-54.563131313131315,-55.519696969696966,-56.476262626262624,-57.43282828282828,-58.38939393939394,-59.3459595959596,-60.30252525252525,-61.25909090909091,-62.215656565656566,-63.172222222222224,-64.12878787878788,-65.08535353535353,-66.04191919191919,-66.99848484848485,-67.95505050505051,-68.91161616161617,-69.86818181818182,-70.82474747474747,-71.78131313131313,-72.73787878787878,-73.69444444444444,-74.6510101010101,-75.60757575757576,-76.56414141414142,-77.52070707070708,-78.47727272727273,-79.43383838383838,-80.39040404040404,-81.3469696969697,-82.30353535353535,-83.26010101010101,-84.21666666666667,-85.17323232323233,-86.12979797979798,-87.08636363636364,-88.04292929292929,-88.99949494949495,-89.9560606060606,-90.91262626262626,-91.86919191919192,-92.82575757575758,-93.78232323232324,-94.7388888888889,-95.69545454545455,-96.65202020202021,-97.60858585858585,-98.56515151515151,-99.52171717171717)
counts=c(0.002346938775510204, 0.9119387755102041,0.08744897959183673,0.0008163265306122449,0.00010204081632653062,0.0005102040816326531,0.0005102040816326531,0.0011224489795918367,0.0014285714285714286,0.001530612244897959,0.003163265306122449,0.42928571428571427,0.5653061224489796,0.0016326530612244899,0.0003061224489795918,0.00010204081632653062,0.00020408163265306123,0.0003061224489795918,0.0005102040816326531,0.001326530612244898,0.0005102040816326531,0.0003061224489795918,0.0009183673469387755,0.00510204081632653,0.017551020408163264,0.027448979591836734,0.13193877551020408,0.17265306122448978,0.15571428571428572,0.31265306122448977,0.1226530612244898,0.04479591836734694,0.005408163265306122,0.004897959183673469,0.0017346938775510204,0.0008163265306122449,0.0007142857142857143,0.00040816326530612246,0.00020408163265306123,0.0005102040816326531,0.00040816326530612246,0.00020408163265306123,0.00020408163265306123,0.0003061224489795918,0.0003061224489795918,0.00040816326530612246,0.0003061224489795918,0.0005102040816326531,0.00040816326530612246,0.0008163265306122449,0.0012244897959183673,0.003775510204081633,0.04112244897959184,0.044897959183673466,0.021122448979591837,0.05244897959183673,0.03306122448979592,0.05479591836734694,0.14908163265306124,0.13051020408163266,0.1826530612244898,0.20438775510204082,0.06612244897959184,0.00989795918367347,0.005408163265306122,0.001836734693877551,0.001326530612244898,0.0009183673469387755,0.0009183673469387755,0.0008163265306122449,0.0006122448979591836,0.0011224489795918367,0.0006122448979591836,0.0011224489795918367,0.0011224489795918367,0.0020408163265306124,0.0032653061224489797,0.005204081632653061,0.00816326530612245,0.014183673469387755,0.004285714285714286,0.006530612244897959,0.006122448979591836,0.003673469387755102,0.0024489795918367346,0.001530612244897959,0.0017346938775510204,0.0017346938775510204,0.001836734693877551,0.001326530612244898,0.0016326530612244899,0.0014285714285714286,0.0014285714285714286,0.0012244897959183673,0.0019387755102040817,0.002142857142857143,0.003673469387755102,0.003775510204081633,0.020714285714285713)
plot(mids,counts,type = 'h', xlim = c(-100.0,-5.3), ylim=c(0,0.9119387755102041), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.03388836258628729
bf6 = 0.2058364133304913
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-6.65045317396705, -8.12833165707084,-9.606210140174628,-11.084088623278417,-12.561967106382205,-14.039845589485994,-15.517724072589784,-16.995602555693576,-18.473481038797363,-19.951359521901153,-21.42923800500494,-22.90711648810873,-24.38499497121252,-25.862873454316308,-27.340751937420098,-28.818630420523885,-30.296508903627675,-31.774387386731465,-33.25226586983525,-34.73014435293904,-36.20802283604283,-37.685901319146616,-39.1637798022504,-40.6416582853542,-42.119536768457984,-43.59741525156177,-45.075293734665564,-46.55317221776935,-48.03105070087314,-49.50892918397693,-50.98680766708072,-52.464686150184505,-53.9425646332883,-55.420443116392086,-56.89832159949587,-58.37620008259966,-59.85407856570345,-61.33195704880724,-62.80983553191103,-64.28771401501483,-65.76559249811862,-67.2434709812224,-68.7213494643262,-70.19922794742999,-71.67710643053377,-73.15498491363756,-74.63286339674134,-76.11074187984514,-77.58862036294893,-79.06649884605271,-80.5443773291565,-82.0222558122603,-83.50013429536408,-84.97801277846787,-86.45589126157167,-87.93376974467544,-89.41164822777924,-90.88952671088303,-92.36740519398681,-93.8452836770906,-95.3231621601944,-96.80104064329818,-98.27891912640197,-99.75679760950577)
rate=c(0.12131501215815028, 0.12131757065987689,0.12132210673050683,0.12133058924252196,0.12133900704708159,0.12133900704708159,0.12133900704708159,0.12133058924252196,0.12132664342456324,0.12131978487590536,0.12131757065987689,0.12131757065987689,0.12132210673050683,0.12132210673050683,0.12132210673050683,0.12132664342456324,0.12132664342456324,0.12132956271238735,0.12133058924252196,0.1213078545862099,0.12119923392135543,0.12079477247650552,0.12050993395939907,0.12012670949868073,0.11968415629871108,0.11747482743352203,0.06347504430457018,0.05851178582776584,0.05699499044724404,0.05661574619392733,0.056599603831836015,0.05659277155716149,0.05661574619392733,0.05664731259313295,0.05663643028081254,0.05663643028081254,0.05671608893899431,0.05722690236841117,0.05830475733788144,0.05881485132171045,0.06164082053472039,0.20310536440248456,0.21549751343255127,0.21595320383477462,0.21589176846051472,0.21598548236876075,0.21595320383477462,0.21586767282868036,0.21580122743613117,0.21589176846051472,0.21602732595460067,0.2160878462024174,0.216164592588528,0.21676327345760882,0.21714040273261398,0.21762921295252152,0.21791490199426963,0.2180527343594526,0.21812965170199242,0.21788858711824066,0.21778039720661285,0.2176314735934055,0.2176314735934055,0.21762000042483082)
minHPD=c(0.10579157940936455, 0.10579157940936455,0.10581070414043038,0.10705602619163411,0.10602324539030604,0.10602324539030604,0.10711081993818014,0.10602324539030604,0.10714461716692252,0.10714461716692252,0.10711081993818014,0.10707825866396951,0.10707825866396951,0.10705602619163411,0.10703234873772892,0.10705602619163411,0.10696446906767143,0.10570411887286497,0.10665034093368894,0.10625547341489681,0.10535778655105062,0.09935565534997236,0.07426677443292365,0.06737228298492454,0.0630626954961162,0.05090516779916329,0.03763485607508948,0.03675058523336978,0.03477429292188579,0.035366828481083086,0.03478038077004118,0.034709048832343,0.035816166982684056,0.03521030556850767,0.034709048832343,0.034709048832343,0.0352652243023501,0.03399946819789421,0.029324758216147318,0.029324758216147318,0.03217956326594882,0.04152382835766935,0.10703643608817989,0.10703643608817989,0.10744884002807935,0.10703643608817989,0.10703643608817989,0.1075054513065623,0.10841592367690354,0.1082068305457166,0.1082068305457166,0.10841592367690354,0.108458794908409,0.10897086988010636,0.10897086988010636,0.10921489447265849,0.10941934278049134,0.1084976286446636,0.108458794908409,0.108458794908409,0.1084976286446636,0.10878674639932137,0.108458794908409,0.10730321316794955)
maxHPD=c(0.13712572387977146, 0.1370914999718241,0.1370914999718241,0.13826337269538796,0.13718746085714656,0.13718746085714656,0.13826337269538796,0.1371610481291231,0.13826337269538796,0.13826337269538796,0.13826337269538796,0.13825920810095546,0.13825920810095546,0.13826337269538796,0.13825920810095546,0.13826337269538796,0.13826337269538796,0.13714916360165225,0.13818969587931249,0.13805214175191283,0.13826337269538796,0.14234986757843504,0.1407951530790742,0.13927001273367254,0.13815932807137687,0.13687154477927152,0.12883656027250617,0.12284731913116272,0.11543662020562351,0.11371164722627448,0.11295753234212362,0.11285213772846492,0.11394483255149526,0.11325993572184699,0.11275121070187849,0.11275121070187849,0.11371164722627448,0.11686771744620705,0.1600731806009359,0.17866529636318174,0.22221353163944743,0.29047277085309037,0.3033237267321608,0.29744670754636865,0.2971260075632328,0.2951729635728637,0.2947073457586709,0.29455577451248266,0.2950629937323745,0.2947073457586709,0.2947073457586709,0.2950158909034587,0.29533772433993444,0.2971133710927919,0.29859694718474067,0.3024024554790094,0.3037640361920203,0.30342807959666324,0.3037640361920203,0.3033237267321608,0.30342807959666324,0.3038372685736861,0.3042536754700095,0.3037640361920203)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 0.33467904301701046), xlim = c(-100.0,-5.3), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-5.778282828282828, -6.734848484848485,-7.691414141414142,-8.647979797979797,-9.604545454545455,-10.56111111111111,-11.517676767676768,-12.474242424242423,-13.430808080808081,-14.387373737373736,-15.343939393939394,-16.300505050505052,-17.257070707070707,-18.213636363636365,-19.17020202020202,-20.126767676767678,-21.083333333333336,-22.03989898989899,-22.99646464646465,-23.953030303030303,-24.90959595959596,-25.866161616161616,-26.822727272727274,-27.779292929292932,-28.735858585858587,-29.692424242424245,-30.6489898989899,-31.605555555555554,-32.56212121212121,-33.51868686868687,-34.47525252525252,-35.43181818181818,-36.38838383838384,-37.344949494949496,-38.30151515151515,-39.258080808080805,-40.214646464646464,-41.17121212121212,-42.12777777777777,-43.08434343434343,-44.04090909090909,-44.99747474747475,-45.954040404040406,-46.91060606060606,-47.867171717171715,-48.82373737373737,-49.78030303030303,-50.73686868686869,-51.69343434343434,-52.65,-53.60656565656566,-54.563131313131315,-55.519696969696966,-56.476262626262624,-57.43282828282828,-58.38939393939394,-59.3459595959596,-60.30252525252525,-61.25909090909091,-62.215656565656566,-63.172222222222224,-64.12878787878788,-65.08535353535353,-66.04191919191919,-66.99848484848485,-67.95505050505051,-68.91161616161617,-69.86818181818182,-70.82474747474747,-71.78131313131313,-72.73787878787878,-73.69444444444444,-74.6510101010101,-75.60757575757576,-76.56414141414142,-77.52070707070708,-78.47727272727273,-79.43383838383838,-80.39040404040404,-81.3469696969697,-82.30353535353535,-83.26010101010101,-84.21666666666667,-85.17323232323233,-86.12979797979798,-87.08636363636364,-88.04292929292929,-88.99949494949495,-89.9560606060606,-90.91262626262626,-91.86919191919192,-92.82575757575758,-93.78232323232324,-94.7388888888889,-95.69545454545455,-96.65202020202021,-97.60858585858585,-98.56515151515151,-99.52171717171717)
counts=c(0.00020408163265306123, 0.00040816326530612246,0.00040816326530612246,0.00040816326530612246,0.0007142857142857143,0.0,0.00040816326530612246,0.00020408163265306123,0.00020408163265306123,0.00010204081632653062,0.00010204081632653062,0.00040816326530612246,0.00010204081632653062,0.00020408163265306123,0.0003061224489795918,0.0003061224489795918,0.00020408163265306123,0.00010204081632653062,0.00040816326530612246,0.00010204081632653062,0.00040816326530612246,0.00010204081632653062,0.00010204081632653062,0.0003061224489795918,0.0005102040816326531,0.0006122448979591836,0.0003061224489795918,0.0003061224489795918,0.0016326530612244899,0.0008163265306122449,0.003979591836734694,0.013265306122448979,0.02173469387755102,0.012040816326530613,0.026020408163265306,0.015204081632653061,0.012755102040816327,0.026020408163265306,0.05683673469387755,0.16051020408163266,0.3876530612244898,0.09806122448979591,0.03479591836734694,0.040204081632653065,0.011428571428571429,0.004285714285714286,0.0008163265306122449,0.00020408163265306123,0.0006122448979591836,0.0006122448979591836,0.0005102040816326531,0.0005102040816326531,0.00040816326530612246,0.0003061224489795918,0.00010204081632653062,0.0024489795918367346,0.006122448979591836,0.02510204081632653,0.032857142857142856,0.009081632653061224,0.02163265306122449,0.05357142857142857,0.20959183673469386,0.4386734693877551,0.12959183673469388,0.02336734693877551,0.006224489795918367,0.001836734693877551,0.0017346938775510204,0.0024489795918367346,0.0019387755102040817,0.0014285714285714286,0.0022448979591836735,0.0012244897959183673,0.0009183673469387755,0.0010204081632653062,0.0019387755102040817,0.001530612244897959,0.001836734693877551,0.0010204081632653062,0.0019387755102040817,0.004183673469387755,0.004183673469387755,0.002857142857142857,0.004387755102040816,0.003775510204081633,0.001530612244897959,0.0009183673469387755,0.001326530612244898,0.0012244897959183673,0.001836734693877551,0.0019387755102040817,0.0027551020408163266,0.0016326530612244899,0.0014285714285714286,0.0012244897959183673,0.001836734693877551,0.0019387755102040817,0.0029591836734693877)
plot(mids,counts,type = 'h', xlim = c(-100.0,-5.3), ylim=c(0,0.4386734693877551), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-6.65045317396705, -8.12833165707084,-9.606210140174628,-11.084088623278417,-12.561967106382205,-14.039845589485994,-15.517724072589784,-16.995602555693576,-18.473481038797363,-19.951359521901153,-21.42923800500494,-22.90711648810873,-24.38499497121252,-25.862873454316308,-27.340751937420098,-28.818630420523885,-30.296508903627675,-31.774387386731465,-33.25226586983525,-34.73014435293904,-36.20802283604283,-37.685901319146616,-39.1637798022504,-40.6416582853542,-42.119536768457984,-43.59741525156177,-45.075293734665564,-46.55317221776935,-48.03105070087314,-49.50892918397693,-50.98680766708072,-52.464686150184505,-53.9425646332883,-55.420443116392086,-56.89832159949587,-58.37620008259966,-59.85407856570345,-61.33195704880724,-62.80983553191103,-64.28771401501483,-65.76559249811862,-67.2434709812224,-68.7213494643262,-70.19922794742999,-71.67710643053377,-73.15498491363756,-74.63286339674134,-76.11074187984514,-77.58862036294893,-79.06649884605271,-80.5443773291565,-82.0222558122603,-83.50013429536408,-84.97801277846787,-86.45589126157167,-87.93376974467544,-89.41164822777924,-90.88952671088303,-92.36740519398681,-93.8452836770906,-95.3231621601944,-96.80104064329818,-98.27891912640197,-99.75679760950577)
net_rate=c(0.19331613026529343, -0.041772926926084884,-0.057374569740812544,-0.05738697830224397,-0.057388958766499056,-0.0572943568933444,-0.05711895163817167,-0.05361857703611182,0.07597294066665686,0.07613255612775328,0.07613923038199892,0.07615981920985208,0.07619152037273594,0.076276224614632,0.07631514399587566,0.07608723219609854,0.07351779596142148,0.06006361586883954,0.03401134388062954,-0.007110327442659479,-0.022055838545379104,-0.02220316272718008,-0.021391640237031332,-0.01991871466522171,-0.01837459127071205,-0.01021722734525559,0.020464028575814485,0.030771812904818764,0.03480189897505955,0.035815372259403316,0.03589548889242628,0.0359180947950209,0.03590731961356906,0.036145899220434034,0.04287413275483063,0.04919265675522011,0.05824737311700033,0.06630060231877792,0.10213985346742406,0.1317054217682283,0.16026500046021308,0.06992874424890945,0.04566505345719873,0.04465988042248793,0.044715980025857374,0.044488825134487056,0.044535919708784524,0.044675138344711804,0.044789741645569085,0.045202483741035124,0.04608750943680781,0.048942402239160694,0.05211392581736041,0.05358439124939922,0.053877557031116664,0.05196013516055984,0.051798777458911795,0.05135986455787918,0.05138066980334245,0.05261102965713249,0.05304296737681415,0.053357382532210194,0.054463978375125115,0.056318360671719185)
net_minHPD=c(0.14445800164266287, -0.08833823813403024,-0.08175654710744037,-0.08251680093852001,-0.08187063667737622,-0.08233545705630106,-0.08175654710744037,-0.0856796545386457,0.04213998634032309,0.04289061116653513,0.04289061116653513,0.04289061116653513,0.04289061116653513,0.042629046509642804,0.04289061116653513,0.04120484392245577,0.03516890272320927,-0.03222668260455264,-0.04506013875648664,-0.0521820846736456,-0.05709529722253258,-0.058570750869030755,-0.05839786148039135,-0.05251597611108605,-0.05354247973044851,-0.050963363861170494,-0.04221026842524468,-0.03335176015379425,-0.02021167670261903,-0.017146656197717852,-0.01632587087149888,-0.01632587087149888,-0.016661930714315668,-0.017146656197717852,-0.036664127213103914,-0.028990586376609798,-0.02416768822509574,-0.028204641045599763,-0.03048195363268577,-0.020577883892945917,-0.004721075882117315,-0.08141010043861288,-0.0843052118100166,-0.07835634827801341,-0.08235904080432002,-0.07578153167132742,-0.07578153167132742,-0.08094146022760018,-0.07843811734365924,-0.07931492347605998,-0.07725662889867563,-0.08235904080432002,-0.08232038383266113,-0.08556529271181235,-0.09579583502735467,-0.097003073638885,-0.09785203108394161,-0.09785203108394161,-0.09102145149651591,-0.097003073638885,-0.09203634023392987,-0.09374766349579694,-0.09785203108394161,-0.0984793367822863)
net_maxHPD=c(0.24583611977667302, 0.16803019874171965,-0.03207949587489309,-0.032946987247453596,-0.03236847611117544,-0.032870407790462436,-0.03204882875415968,-0.027804705767909277,0.11126251711675236,0.11144188305172814,0.11136157658292056,0.11136157658292056,0.11134454318872741,0.11136157658292056,0.1117806681815923,0.11136157658292056,0.11749900631162928,0.11126251711675236,0.10264790565388535,0.08629986485174963,0.010705856040940195,0.012173930102157796,0.01946297167274119,0.032598201487551395,0.03515487765962584,0.05186102362640421,0.06760793225240376,0.07042316806435692,0.07525211490048138,0.0751012443026298,0.07551079427544997,0.07540324845628246,0.07525211490048138,0.07579983578622657,0.11438736731446722,0.1634027572804453,0.18939073180885269,0.20979896363068407,0.2633848426966578,0.28139561294330656,0.2989680053970058,0.24822804805766618,0.17698999910126728,0.17698999910126728,0.17163413320324594,0.1770856970425978,0.17693110977430962,0.17157989334456278,0.17352810556612688,0.17163413320324594,0.17352810556612688,0.17558776502098705,0.1844105200171659,0.19066798637245533,0.19030005860241506,0.20087185380471678,0.20150751801726885,0.202686064896515,0.21106984115345853,0.2044279983270838,0.21106984115345853,0.21106984115345853,0.2121473663841632,0.2220696410808235)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-0.10832727046051495, 0.3288648059367064), xlim = c(-100.0,-5.3), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-6.65045317396705, -8.12833165707084,-9.606210140174628,-11.084088623278417,-12.561967106382205,-14.039845589485994,-15.517724072589784,-16.995602555693576,-18.473481038797363,-19.951359521901153,-21.42923800500494,-22.90711648810873,-24.38499497121252,-25.862873454316308,-27.340751937420098,-28.818630420523885,-30.296508903627675,-31.774387386731465,-33.25226586983525,-34.73014435293904,-36.20802283604283,-37.685901319146616,-39.1637798022504,-40.6416582853542,-42.119536768457984,-43.59741525156177,-45.075293734665564,-46.55317221776935,-48.03105070087314,-49.50892918397693,-50.98680766708072,-52.464686150184505,-53.9425646332883,-55.420443116392086,-56.89832159949587,-58.37620008259966,-59.85407856570345,-61.33195704880724,-62.80983553191103,-64.28771401501483,-65.76559249811862,-67.2434709812224,-68.7213494643262,-70.19922794742999,-71.67710643053377,-73.15498491363756,-74.63286339674134,-76.11074187984514,-77.58862036294893,-79.06649884605271,-80.5443773291565,-82.0222558122603,-83.50013429536408,-84.97801277846787,-86.45589126157167,-87.93376974467544,-89.41164822777924,-90.88952671088303,-92.36740519398681,-93.8452836770906,-95.3231621601944,-96.80104064329818,-98.27891912640197,-99.75679760950577)
rate=c(8.23921586497566, 8.238560547846392,8.237866012900302,8.236759005221083,8.236096755864601,8.236178175681536,8.236072845452828,8.236728098300503,8.237335497202876,8.238454410246028,8.23872796747099,8.238988351133107,8.238660404610474,8.238888099982473,8.23899532779357,8.238707847751972,8.238057506657237,8.23648883360691,8.23745538862582,8.241851812985796,8.268006070363395,8.393201826031234,8.487186275806993,8.599511242083695,8.718226165952244,9.3850525826165,13.180313285038524,15.254525959660633,16.254729784452472,16.530109184835776,16.550585001242634,16.557256629290848,16.550356816633393,16.545251207988393,16.547694220730918,16.547759411968215,16.477830430033176,15.84009062534736,14.532695046793517,13.90872295854524,11.238831011785033,5.294154026821285,4.670059473695038,4.646988424856363,4.648326934011321,4.643708162665512,4.643940106347454,4.645018258718867,4.646292170869657,4.6435533591748985,4.638454308157845,4.634853430728426,4.62981913065892,4.6041018782650704,4.582527078302315,4.533452794980311,4.5268904937400425,4.522665267280693,4.521871006426088,4.542733345571535,4.548444143313282,4.5515527665160285,4.5508626796862215,4.5428976336485585)
minHPD=c(8.23921586497566, 8.238560547846392,8.237866012900302,8.236759005221083,8.236096755864601,8.236178175681536,8.236072845452828,8.236728098300503,8.237335497202876,8.238454410246028,8.23872796747099,8.238988351133107,8.238660404610474,8.238888099982473,8.23899532779357,8.238707847751972,8.238057506657237,8.23648883360691,8.23745538862582,8.241851812985796,8.268006070363395,8.393201826031234,8.487186275806993,8.599511242083695,8.718226165952244,9.3850525826165,13.180313285038524,15.254525959660633,16.254729784452472,16.530109184835776,16.550585001242634,16.557256629290848,16.550356816633393,16.545251207988393,16.547694220730918,16.547759411968215,16.477830430033176,15.84009062534736,14.532695046793517,13.90872295854524,11.238831011785033,5.294154026821285,4.670059473695038,4.646988424856363,4.648326934011321,4.643708162665512,4.643940106347454,4.645018258718867,4.646292170869657,4.6435533591748985,4.638454308157845,4.634853430728426,4.62981913065892,4.6041018782650704,4.582527078302315,4.533452794980311,4.5268904937400425,4.522665267280693,4.521871006426088,4.542733345571535,4.548444143313282,4.5515527665160285,4.5508626796862215,4.5428976336485585)
maxHPD=c(8.23921586497566, 8.238560547846392,8.237866012900302,8.236759005221083,8.236096755864601,8.236178175681536,8.236072845452828,8.236728098300503,8.237335497202876,8.238454410246028,8.23872796747099,8.238988351133107,8.238660404610474,8.238888099982473,8.23899532779357,8.238707847751972,8.238057506657237,8.23648883360691,8.23745538862582,8.241851812985796,8.268006070363395,8.393201826031234,8.487186275806993,8.599511242083695,8.718226165952244,9.3850525826165,13.180313285038524,15.254525959660633,16.254729784452472,16.530109184835776,16.550585001242634,16.557256629290848,16.550356816633393,16.545251207988393,16.547694220730918,16.547759411968215,16.477830430033176,15.84009062534736,14.532695046793517,13.90872295854524,11.238831011785033,5.294154026821285,4.670059473695038,4.646988424856363,4.648326934011321,4.643708162665512,4.643940106347454,4.645018258718867,4.646292170869657,4.6435533591748985,4.638454308157845,4.634853430728426,4.62981913065892,4.6041018782650704,4.582527078302315,4.533452794980311,4.5268904937400425,4.522665267280693,4.521871006426088,4.542733345571535,4.548444143313282,4.5515527665160285,4.5508626796862215,4.5428976336485585)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 18.212982292219934), xlim = c(-100.0,-5.3), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()