

pdf(file='/Users/max/Desktop/Phylogenetic_cowries/pyrate_mcmc_logs/pyrate_mcmc_logs/RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-0.7389392415518945, -2.2168177246556837,-3.694696207759473,-5.172574690863262,-6.65045317396705,-8.12833165707084,-9.606210140174628,-11.084088623278417,-12.561967106382205,-14.039845589485994,-15.517724072589784,-16.995602555693576,-18.473481038797363,-19.951359521901153,-21.42923800500494,-22.90711648810873,-24.38499497121252,-25.862873454316308,-27.340751937420098,-28.818630420523885,-30.296508903627675,-31.774387386731465,-33.25226586983525,-34.73014435293904,-36.20802283604283,-37.685901319146616,-39.1637798022504,-40.6416582853542,-42.119536768457984,-43.59741525156177,-45.075293734665564,-46.55317221776935,-48.03105070087314,-49.50892918397693,-50.98680766708072,-52.464686150184505,-53.9425646332883,-55.420443116392086,-56.89832159949587,-58.37620008259966,-59.85407856570345,-61.33195704880724,-62.80983553191103,-64.28771401501483,-65.76559249811862,-67.2434709812224,-68.7213494643262,-70.19922794742999,-71.67710643053377,-73.15498491363756,-74.63286339674134,-76.11074187984514,-77.58862036294893,-79.06649884605271,-80.5443773291565,-82.0222558122603,-83.50013429536408,-84.97801277846787,-86.45589126157167,-87.93376974467544,-89.41164822777924,-90.88952671088303,-92.36740519398681,-93.8452836770906,-95.3231621601944,-96.80104064329818,-98.27891912640197,-99.75679760950577,-101.23467609260955,-102.71255457571334,-104.19043305881713,-105.66831154192091,-107.14619002502471,-108.6240685081285,-110.10194699123228,-111.57982547433608,-113.05770395743987,-114.53558244054365,-116.01346092364744,-117.49133940675122,-118.96921788985502,-120.44709637295881,-121.92497485606259,-123.40285333916638,-124.88073182227018,-126.35861030537396,-127.83648878847777,-129.31436727158155,-130.79224575468533,-132.27012423778913,-133.7480027208929,-135.2258812039967,-136.7037596871005,-138.18163817020428,-139.65951665330806,-141.13739513641187,-142.61527361951565,-144.09315210261943,-145.5710305857232,-147.04890906882702)
rate=c(0.31314689000979634, 0.31313818643696517,0.31314981265608755,0.3136788299871437,0.3136387638548145,0.06461347601292769,0.06355343706510039,0.06355477370490645,0.0635593230318714,0.0635953804307049,0.0636400250964475,0.06401999925024693,0.1970689190900307,0.19708881778444276,0.19708881778444276,0.19710428400318897,0.1971267508777994,0.19717440108120474,0.19719130523070716,0.19715019127641367,0.19658024119720144,0.1927757073025178,0.17963508020731722,0.09987066971520017,0.09656610525955017,0.09614277973941493,0.09604057600566757,0.09602014423774974,0.09600868682238312,0.09601523038661802,0.09601523038661802,0.09600868682238312,0.09600656688762449,0.095998255500142,0.095998255500142,0.09599554315417297,0.095998255500142,0.09604057600566757,0.0973703128234188,0.09853224503385194,0.10021317302021336,0.10211128437728137,0.12680719769241722,0.22623134877191944,0.2545032266304669,0.2587707768934712,0.2592047663907274,0.25924937853670776,0.2592456544686849,0.2592456544686849,0.25926061936571154,0.25930564574748527,0.2593616649801401,0.25967013506050074,0.26018171456236583,0.2612452067661279,0.2625322279412384,0.26359535903400594,0.2640456311884284,0.26424565040737186,0.2643248537913069,0.2643964013146438,0.26444817176787455,0.2644925416360012,0.264502459114328,0.2645615794992655,0.2646677282588408,0.2648781031850882,0.2669549385499136,0.3070122918314162,0.40198079487085797,2.667534811846884,3.2447483667049513,3.6929900709003913,4.005648284583984,4.051930585200561,4.074439392459654,4.0797393051106745,4.084484548461921,4.089902392063536,4.100364839928623,4.104459798049962,4.113390390139651,4.1230467313856956,4.12331916024394,4.122638818602894,4.122638818602894,4.122217893904065,4.122217893904065,4.121979123129961,4.121715551918414,4.120144933296139,4.120465049951923,4.119503529645593,4.119503529645593,4.116992340320999,4.116992340320999,4.116756518173136,4.11462064631926,4.113716266073849)
minHPD=c(0.26537160625951367, 0.2654703354327761,0.2653850077190521,0.2653850077190521,0.2653850077190521,0.037176182683436525,0.04507256281591538,0.04507256281591538,0.04514666081791613,0.04516407696130235,0.045640744991027445,0.04330756630510344,0.16702175253824586,0.16697449811253304,0.16697449811253304,0.16697449811253304,0.16691513147505715,0.1672181880269817,0.1670710053495969,0.16697449811253304,0.16199481476850378,0.08946928351820267,0.08097153472726992,0.07231709462264233,0.07140397606044434,0.07370052188170731,0.07414969466450738,0.07415933214275959,0.07414969466450738,0.07384964319438124,0.07387372228204032,0.07384964319438124,0.07387372228204032,0.07387372228204032,0.07374634772577869,0.07374634772577869,0.07414969466450738,0.07373322378324973,0.06720024219461007,0.07086811289197414,0.07220735216477008,0.07220735216477008,0.07773636998605248,0.07803804306443561,0.09568387176735968,0.17809965460011623,0.17682080391882346,0.17682080391882346,0.17580002571663764,0.1761365606088876,0.17627384403831423,0.17682080391882346,0.17682080391882346,0.17762179577530188,0.17682080391882346,0.17682080391882346,0.17682080391882346,0.1764589640188057,0.1778882025174919,0.1764589640188057,0.17682080391882346,0.1761365606088876,0.1778882025174919,0.17682080391882346,0.17515838076299714,0.17236901802246007,0.16965724933429194,0.1721823203882387,0.15941537381727217,0.15344260237969118,0.15647515561064593,0.1599884210243558,0.1599884210243558,0.16135774456174393,0.18914599273529323,0.21015707472355769,1.403255331714163,1.431416486589735,1.4191199704401798,1.4533770375027468,1.4774509738453945,1.5084541882464935,1.4883243832145086,1.7634816571271732,1.7073318925030938,1.7073318925030938,1.7073318925030938,1.7095544910012694,1.7073318925030938,1.632322302151637,1.61444539414601,1.632322302151637,1.61444539414601,1.5084541882464935,1.6021237446345096,1.5961742371236756,1.5961742371236756,1.5963979276681053,1.6021237446345096,1.5963979276681053)
maxHPD=c(0.36117089516804823, 0.36117089516804823,0.361023415612612,0.3620524040359775,0.3620524040359775,0.286628709244958,0.08374868841371295,0.0837224570149328,0.0837224570149328,0.0837224570149328,0.08444275402514478,0.08858452585162323,0.22867601673207846,0.2282313261072289,0.2282313261072289,0.2282313261072289,0.22824370870746713,0.22867601673207846,0.22863359792589827,0.22944659350055427,0.23482371049579887,0.2265422063963767,0.2213874170504432,0.20320677660839234,0.12343302554225867,0.11988097629426162,0.119133847691277,0.1190802797820839,0.11903298543866415,0.11871241251502715,0.11871241251502715,0.11864783125988634,0.11871241251502715,0.11871241251502715,0.11864783125988634,0.11864783125988634,0.119133847691277,0.1192193480336202,0.1822350281920281,0.2199025263615992,0.2413946933021552,0.25460758762916247,0.2979344408787496,0.3137832032771485,0.3387669188582215,0.3561760710243311,0.348972063064157,0.3486819618527091,0.3473616856711023,0.3474334827382414,0.3474334827382414,0.3474334827382414,0.34730265234183244,0.3473616856711023,0.34673266415000964,0.3514244710757491,0.35768904435633214,0.36384751801874865,0.3695750789537414,0.36982152529434426,0.37095237754963284,0.37095237754963284,0.37402026622143947,0.37402026622143947,0.37485599814134374,0.37402026622143947,0.37698746743612876,0.38888066256710674,0.4915797568529953,5.929094499131982,6.214228472564144,6.450706784635769,6.5892680987890495,6.711518294439011,6.867508437861508,6.927918615791096,7.866693533919776,7.814511222388142,7.672690630674615,7.56643051436837,7.416803903271472,7.336712301171141,7.202178082433889,7.347578459144278,7.279176992097807,7.273494281868673,7.26893676756978,7.26893676756978,7.273494281868673,7.197393279575246,7.183676953139442,7.197393279575246,7.188140411086287,7.085747340479278,7.182102221976045,7.177280073136185,7.177280073136185,7.177280073136185,7.182102221976045,7.177280073136185)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 8.653362887311754), xlim = c(-147.7878483103789,-0.0), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (Phylogenetic_cowriesV2_1_Grj_se_est_0_rj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-0.746403274294843, -2.239209822884529,-3.7320163714742156,-5.224822920063901,-6.717629468653587,-8.210436017243273,-9.703242565832959,-11.196049114422644,-12.68885566301233,-14.181662211602015,-15.674468760191703,-17.16727530878139,-18.660081857371075,-20.152888405960763,-21.645694954550446,-23.138501503140134,-24.63130805172982,-26.124114600319505,-27.616921148909192,-29.109727697498876,-30.602534246088563,-32.09534079467825,-33.588147343267934,-35.080953891857625,-36.57376044044731,-38.06656698903699,-39.559373537626676,-41.05218008621637,-42.54498663480605,-44.037793183395735,-45.530599731985426,-47.02340628057511,-48.51621282916479,-50.009019377754484,-51.50182592634417,-52.99463247493385,-54.48743902352354,-55.980245572113226,-57.47305212070291,-58.965858669292594,-60.458665217882285,-61.95147176647197,-63.44427831506166,-64.93708486365134,-66.42989141224102,-67.9226979608307,-69.41550450942039,-70.90831105801009,-72.40111760659977,-73.89392415518945,-75.38673070377914,-76.87953725236882,-78.3723438009585,-79.86515034954819,-81.35795689813789,-82.85076344672757,-84.34356999531725,-85.83637654390694,-87.32918309249662,-88.8219896410863,-90.314796189676,-91.80760273826569,-93.30040928685537,-94.79321583544505,-96.28602238403474,-97.77882893262442,-99.2716354812141,-100.7644420298038,-102.25724857839349,-103.75005512698317,-105.24286167557285,-106.73566822416254,-108.22847477275222,-109.72128132134192,-111.2140878699316,-112.70689441852129,-114.19970096711097,-115.69250751570065,-117.18531406429034,-118.67812061288002,-120.17092716146972,-121.6637337100594,-123.15654025864909,-124.64934680723877,-126.14215335582846,-127.63495990441815,-129.12776645300784,-130.62057300159753,-132.1133795501872,-133.6061860987769,-135.0989926473666,-136.59179919595627,-138.08460574454597,-139.57741229313564,-141.07021884172534,-142.56302539031503,-144.0558319389047,-145.5486384874944,-147.04144503608407)
counts=c(0.0008163265306122449, 0.0017346938775510204,0.00989795918367347,0.001836734693877551,0.9459183673469388,0.05581632653061225,0.00020408163265306123,0.0007142857142857143,0.0022448979591836735,0.0020408163265306124,0.060408163265306125,0.9376530612244898,0.0016326530612244899,0.00010204081632653062,0.0005102040816326531,0.0010204081632653062,0.001326530612244898,0.0007142857142857143,0.0070408163265306125,0.03561224489795918,0.18622448979591838,0.24724489795918367,0.3933673469387755,0.11938775510204082,0.010408163265306122,0.003775510204081633,0.0014285714285714286,0.0005102040816326531,0.0007142857142857143,0.00040816326530612246,0.0003061224489795918,0.0006122448979591836,0.0005102040816326531,0.0005102040816326531,0.0008163265306122449,0.001326530612244898,0.007448979591836735,0.07938775510204081,0.036326530612244896,0.0686734693877551,0.09938775510204081,0.2403061224489796,0.3335714285714286,0.12163265306122449,0.012755102040816327,0.0024489795918367346,0.001836734693877551,0.0014285714285714286,0.0011224489795918367,0.001530612244897959,0.001326530612244898,0.002142857142857143,0.004693877551020408,0.01173469387755102,0.017346938775510204,0.007448979591836735,0.009285714285714286,0.004387755102040816,0.0022448979591836735,0.0027551020408163266,0.0027551020408163266,0.0024489795918367346,0.0024489795918367346,0.0017346938775510204,0.0034693877551020408,0.005408163265306122,0.02316326530612245,0.2947959183673469,0.13316326530612244,0.10908163265306123,0.10724489795918367,0.12520408163265306,0.126734693877551,0.059387755102040814,0.020612244897959184,0.003979591836734694,0.003673469387755102,0.004183673469387755,0.007959183673469388,0.005816326530612245,0.005510204081632653,0.0064285714285714285,0.0020408163265306124,0.0010204081632653062,0.0003061224489795918,0.0009183673469387755,0.0016326530612244899,0.0009183673469387755,0.0011224489795918367,0.001326530612244898,0.0009183673469387755,0.0010204081632653062,0.0011224489795918367,0.0011224489795918367,0.0012244897959183673,0.0006122448979591836,0.001530612244897959,0.0008163265306122449,0.001530612244897959)
plot(mids,counts,type = 'h', xlim = c(-147.7878483103789,-0.0), ylim=c(0,0.9459183673469388), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.034997086016957446
bf6 = 0.21134012868932298
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-0.7389392415518945, -2.2168177246556837,-3.694696207759473,-5.172574690863262,-6.65045317396705,-8.12833165707084,-9.606210140174628,-11.084088623278417,-12.561967106382205,-14.039845589485994,-15.517724072589784,-16.995602555693576,-18.473481038797363,-19.951359521901153,-21.42923800500494,-22.90711648810873,-24.38499497121252,-25.862873454316308,-27.340751937420098,-28.818630420523885,-30.296508903627675,-31.774387386731465,-33.25226586983525,-34.73014435293904,-36.20802283604283,-37.685901319146616,-39.1637798022504,-40.6416582853542,-42.119536768457984,-43.59741525156177,-45.075293734665564,-46.55317221776935,-48.03105070087314,-49.50892918397693,-50.98680766708072,-52.464686150184505,-53.9425646332883,-55.420443116392086,-56.89832159949587,-58.37620008259966,-59.85407856570345,-61.33195704880724,-62.80983553191103,-64.28771401501483,-65.76559249811862,-67.2434709812224,-68.7213494643262,-70.19922794742999,-71.67710643053377,-73.15498491363756,-74.63286339674134,-76.11074187984514,-77.58862036294893,-79.06649884605271,-80.5443773291565,-82.0222558122603,-83.50013429536408,-84.97801277846787,-86.45589126157167,-87.93376974467544,-89.41164822777924,-90.88952671088303,-92.36740519398681,-93.8452836770906,-95.3231621601944,-96.80104064329818,-98.27891912640197,-99.75679760950577,-101.23467609260955,-102.71255457571334,-104.19043305881713,-105.66831154192091,-107.14619002502471,-108.6240685081285,-110.10194699123228,-111.57982547433608,-113.05770395743987,-114.53558244054365,-116.01346092364744,-117.49133940675122,-118.96921788985502,-120.44709637295881,-121.92497485606259,-123.40285333916638,-124.88073182227018,-126.35861030537396,-127.83648878847777,-129.31436727158155,-130.79224575468533,-132.27012423778913,-133.7480027208929,-135.2258812039967,-136.7037596871005,-138.18163817020428,-139.65951665330806,-141.13739513641187,-142.61527361951565,-144.09315210261943,-145.5710305857232,-147.04890906882702)
rate=c(0.3208490539357878, 0.3629303798066851,0.5615216558394911,0.1213078545862099,0.12131501215815028,0.12131757065987689,0.12132210673050683,0.12133058924252196,0.12133900704708159,0.12133900704708159,0.12133900704708159,0.12133058924252196,0.12132664342456324,0.12131978487590536,0.12131757065987689,0.12131757065987689,0.12132210673050683,0.12132210673050683,0.12132210673050683,0.12132664342456324,0.12132664342456324,0.12132956271238735,0.12133058924252196,0.1213078545862099,0.12119923392135543,0.12079477247650552,0.12050993395939907,0.12012670949868073,0.11968415629871108,0.11747482743352203,0.06347504430457018,0.05851178582776584,0.05699499044724404,0.05661574619392733,0.056599603831836015,0.05659277155716149,0.05661574619392733,0.05664731259313295,0.05663643028081254,0.05663643028081254,0.05671608893899431,0.05722690236841117,0.05830475733788144,0.05881485132171045,0.06164082053472039,0.20310536440248456,0.21549751343255127,0.21595320383477462,0.21589176846051472,0.21598548236876075,0.21595320383477462,0.21586767282868036,0.21580122743613117,0.21589176846051472,0.21602732595460067,0.2160878462024174,0.216164592588528,0.21676327345760882,0.21714040273261398,0.21762921295252152,0.21791490199426963,0.2180527343594526,0.21812965170199242,0.21788858711824066,0.21778039720661285,0.2176314735934055,0.2176314735934055,0.21762000042483082,0.21779442738957341,0.22239955556053329,0.23636485964651804,0.2686483119025504,2.8935695368667083,3.659539474634534,4.0667480848881405,4.109936943904244,4.137234370393087,4.139582985879342,4.144739092868438,4.1511241337446485,4.153313350735084,4.155718621113315,4.163125295926043,4.164403258258128,4.165027565414431,4.164791670271684,4.164174802998753,4.164113688862375,4.163372615908365,4.16306723161552,4.160940701379811,4.159654240145139,4.15913095937718,4.157340682967219,4.156976964933475,4.155797136820266,4.155797136820266,4.156506447924744,4.156506447924744,4.155154673851163)
minHPD=c(0.2031746198938925, 0.20285285757761992,0.33863371392962655,0.10573937441662216,0.10579157940936455,0.10579157940936455,0.10581070414043038,0.10705602619163411,0.10602324539030604,0.10602324539030604,0.10711081993818014,0.10602324539030604,0.10714461716692252,0.10714461716692252,0.10711081993818014,0.10707825866396951,0.10707825866396951,0.10705602619163411,0.10703234873772892,0.10705602619163411,0.10696446906767143,0.10570411887286497,0.10665034093368894,0.10625547341489681,0.10535778655105062,0.09935565534997236,0.07426677443292365,0.06737228298492454,0.0630626954961162,0.05090516779916329,0.03763485607508948,0.03675058523336978,0.03477429292188579,0.035366828481083086,0.03478038077004118,0.034709048832343,0.035816166982684056,0.03521030556850767,0.034709048832343,0.034709048832343,0.0352652243023501,0.03399946819789421,0.029324758216147318,0.029324758216147318,0.03217956326594882,0.04152382835766935,0.10703643608817989,0.10703643608817989,0.10744884002807935,0.10703643608817989,0.10703643608817989,0.1075054513065623,0.10841592367690354,0.1082068305457166,0.1082068305457166,0.10841592367690354,0.108458794908409,0.10897086988010636,0.10897086988010636,0.10921489447265849,0.10941934278049134,0.1084976286446636,0.108458794908409,0.108458794908409,0.1084976286446636,0.10878674639932137,0.108458794908409,0.10730321316794955,0.108458794908409,0.07123828578437258,0.0854489651109712,0.1010376662204568,0.1016916552128739,0.10234903570907536,0.1578167960637793,1.2574758742066638,1.6179883760268994,1.518974105621583,1.5414572372271647,1.6872784832254728,1.7012567041722768,1.7049024624640714,1.7982285500191695,1.7102540856109234,1.7082739512586833,1.7082739512586833,1.7082739512586833,1.7082739512586833,1.7082739512586833,1.7082739512586833,1.7082739512586833,1.7082739512586833,1.7082739512586833,1.7082739512586833,1.6950406751591458,1.7082739512586833,1.7082739512586833,1.7082739512586833,1.6950406751591458,1.6950406751591458)
maxHPD=c(0.4989815316611351, 0.6055418134050238,0.8718487928542096,0.1371610481291231,0.13712572387977146,0.1370914999718241,0.1370914999718241,0.13826337269538796,0.13718746085714656,0.13718746085714656,0.13826337269538796,0.1371610481291231,0.13826337269538796,0.13826337269538796,0.13826337269538796,0.13825920810095546,0.13825920810095546,0.13826337269538796,0.13825920810095546,0.13826337269538796,0.13826337269538796,0.13714916360165225,0.13818969587931249,0.13805214175191283,0.13826337269538796,0.14234986757843504,0.1407951530790742,0.13927001273367254,0.13815932807137687,0.13687154477927152,0.12883656027250617,0.12284731913116272,0.11543662020562351,0.11371164722627448,0.11295753234212362,0.11285213772846492,0.11394483255149526,0.11325993572184699,0.11275121070187849,0.11275121070187849,0.11371164722627448,0.11686771744620705,0.1600731806009359,0.17866529636318174,0.22221353163944743,0.29047277085309037,0.3033237267321608,0.29744670754636865,0.2971260075632328,0.2951729635728637,0.2947073457586709,0.29455577451248266,0.2950629937323745,0.2947073457586709,0.2947073457586709,0.2950158909034587,0.29533772433993444,0.2971133710927919,0.29859694718474067,0.3024024554790094,0.3037640361920203,0.30342807959666324,0.3037640361920203,0.3033237267321608,0.30342807959666324,0.3038372685736861,0.3042536754700095,0.3037640361920203,0.3077404041307481,3.5601110761069106,5.371300666035494,6.124981888542406,6.4628406927159014,6.724329053345788,6.9004830523759875,7.825856368300437,7.630351049057506,7.4372137239653675,7.38980997056676,7.440770647959681,7.3966288500388595,7.341723665493777,7.332509872222387,7.200138917253467,7.199897517321046,7.200138917253467,7.200138917253467,7.200138917253467,7.212961222375532,7.215580118656821,7.236314408452955,7.23454050934314,7.235390472586015,7.23454050934314,7.215580118656821,7.235390472586015,7.23454050934314,7.23454050934314,7.215580118656821,7.235390472586015)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 8.608442005130481), xlim = c(-147.7878483103789,-0.0), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-0.746403274294843, -2.239209822884529,-3.7320163714742156,-5.224822920063901,-6.717629468653587,-8.210436017243273,-9.703242565832959,-11.196049114422644,-12.68885566301233,-14.181662211602015,-15.674468760191703,-17.16727530878139,-18.660081857371075,-20.152888405960763,-21.645694954550446,-23.138501503140134,-24.63130805172982,-26.124114600319505,-27.616921148909192,-29.109727697498876,-30.602534246088563,-32.09534079467825,-33.588147343267934,-35.080953891857625,-36.57376044044731,-38.06656698903699,-39.559373537626676,-41.05218008621637,-42.54498663480605,-44.037793183395735,-45.530599731985426,-47.02340628057511,-48.51621282916479,-50.009019377754484,-51.50182592634417,-52.99463247493385,-54.48743902352354,-55.980245572113226,-57.47305212070291,-58.965858669292594,-60.458665217882285,-61.95147176647197,-63.44427831506166,-64.93708486365134,-66.42989141224102,-67.9226979608307,-69.41550450942039,-70.90831105801009,-72.40111760659977,-73.89392415518945,-75.38673070377914,-76.87953725236882,-78.3723438009585,-79.86515034954819,-81.35795689813789,-82.85076344672757,-84.34356999531725,-85.83637654390694,-87.32918309249662,-88.8219896410863,-90.314796189676,-91.80760273826569,-93.30040928685537,-94.79321583544505,-96.28602238403474,-97.77882893262442,-99.2716354812141,-100.7644420298038,-102.25724857839349,-103.75005512698317,-105.24286167557285,-106.73566822416254,-108.22847477275222,-109.72128132134192,-111.2140878699316,-112.70689441852129,-114.19970096711097,-115.69250751570065,-117.18531406429034,-118.67812061288002,-120.17092716146972,-121.6637337100594,-123.15654025864909,-124.64934680723877,-126.14215335582846,-127.63495990441815,-129.12776645300784,-130.62057300159753,-132.1133795501872,-133.6061860987769,-135.0989926473666,-136.59179919595627,-138.08460574454597,-139.57741229313564,-141.07021884172534,-142.56302539031503,-144.0558319389047,-145.5486384874944,-147.04144503608407)
counts=c(0.13459183673469388, 1.081734693877551,0.44346938775510203,0.0006122448979591836,0.0006122448979591836,0.0005102040816326531,0.0009183673469387755,0.00040816326530612246,0.0003061224489795918,0.00020408163265306123,0.0003061224489795918,0.0003061224489795918,0.0005102040816326531,0.00040816326530612246,0.00020408163265306123,0.00040816326530612246,0.0005102040816326531,0.00020408163265306123,0.0006122448979591836,0.0005102040816326531,0.0007142857142857143,0.001326530612244898,0.002653061224489796,0.014183673469387755,0.030612244897959183,0.03193877551020408,0.021836734693877553,0.0336734693877551,0.18448979591836734,0.4520408163265306,0.09326530612244897,0.052244897959183675,0.009183673469387756,0.0010204081632653062,0.0007142857142857143,0.0010204081632653062,0.0005102040816326531,0.0006122448979591836,0.0006122448979591836,0.0069387755102040816,0.049489795918367344,0.018775510204081632,0.054387755102040816,0.2896938775510204,0.5008163265306123,0.034081632653061224,0.005204081632653061,0.002653061224489796,0.003673469387755102,0.002653061224489796,0.0024489795918367346,0.001326530612244898,0.002551020408163265,0.002551020408163265,0.0019387755102040817,0.005408163265306122,0.005612244897959183,0.006122448979591836,0.004693877551020408,0.0017346938775510204,0.002142857142857143,0.002346938775510204,0.004285714285714286,0.002551020408163265,0.0020408163265306124,0.0027551020408163266,0.003979591836734694,0.037653061224489796,0.16561224489795917,0.17551020408163265,0.18306122448979592,0.18775510204081633,0.18948979591836734,0.053877551020408164,0.02122448979591837,0.0035714285714285713,0.002653061224489796,0.004489795918367347,0.002857142857142857,0.002346938775510204,0.005816326530612245,0.002857142857142857,0.0009183673469387755,0.0011224489795918367,0.001836734693877551,0.001326530612244898,0.0007142857142857143,0.0009183673469387755,0.0020408163265306124,0.0016326530612244899,0.0006122448979591836,0.001530612244897959,0.001530612244897959,0.0017346938775510204,0.0006122448979591836,0.0007142857142857143,0.0012244897959183673,0.0020408163265306124,0.0016326530612244899)
plot(mids,counts,type = 'h', xlim = c(-147.7878483103789,-0.0), ylim=c(0,1.081734693877551), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-0.7389392415518945, -2.2168177246556837,-3.694696207759473,-5.172574690863262,-6.65045317396705,-8.12833165707084,-9.606210140174628,-11.084088623278417,-12.561967106382205,-14.039845589485994,-15.517724072589784,-16.995602555693576,-18.473481038797363,-19.951359521901153,-21.42923800500494,-22.90711648810873,-24.38499497121252,-25.862873454316308,-27.340751937420098,-28.818630420523885,-30.296508903627675,-31.774387386731465,-33.25226586983525,-34.73014435293904,-36.20802283604283,-37.685901319146616,-39.1637798022504,-40.6416582853542,-42.119536768457984,-43.59741525156177,-45.075293734665564,-46.55317221776935,-48.03105070087314,-49.50892918397693,-50.98680766708072,-52.464686150184505,-53.9425646332883,-55.420443116392086,-56.89832159949587,-58.37620008259966,-59.85407856570345,-61.33195704880724,-62.80983553191103,-64.28771401501483,-65.76559249811862,-67.2434709812224,-68.7213494643262,-70.19922794742999,-71.67710643053377,-73.15498491363756,-74.63286339674134,-76.11074187984514,-77.58862036294893,-79.06649884605271,-80.5443773291565,-82.0222558122603,-83.50013429536408,-84.97801277846787,-86.45589126157167,-87.93376974467544,-89.41164822777924,-90.88952671088303,-92.36740519398681,-93.8452836770906,-95.3231621601944,-96.80104064329818,-98.27891912640197,-99.75679760950577,-101.23467609260955,-102.71255457571334,-104.19043305881713,-105.66831154192091,-107.14619002502471,-108.6240685081285,-110.10194699123228,-111.57982547433608,-113.05770395743987,-114.53558244054365,-116.01346092364744,-117.49133940675122,-118.96921788985502,-120.44709637295881,-121.92497485606259,-123.40285333916638,-124.88073182227018,-126.35861030537396,-127.83648878847777,-129.31436727158155,-130.79224575468533,-132.27012423778913,-133.7480027208929,-135.2258812039967,-136.7037596871005,-138.18163817020428,-139.65951665330806,-141.13739513641187,-142.61527361951565,-144.09315210261943,-145.5710305857232,-147.04890906882702)
net_rate=c(-0.025015284164088002, -0.06603610606690856,-0.2356510731732651,0.19357878452831045,0.19331613026529343,-0.041772926926084884,-0.057374569740812544,-0.05738697830224397,-0.057388958766499056,-0.0572943568933444,-0.05711895163817167,-0.05361857703611182,0.07597294066665686,0.07613255612775328,0.07613923038199892,0.07615981920985208,0.07619152037273594,0.076276224614632,0.07631514399587566,0.07608723219609854,0.07351779596142148,0.06006361586883954,0.03401134388062954,-0.007110327442659479,-0.022055838545379104,-0.02220316272718008,-0.021391640237031332,-0.01991871466522171,-0.01837459127071205,-0.01021722734525559,0.020464028575814485,0.030771812904818764,0.03480189897505955,0.035815372259403316,0.03589548889242628,0.0359180947950209,0.03590731961356906,0.036145899220434034,0.04287413275483063,0.04919265675522011,0.05824737311700033,0.06630060231877792,0.10213985346742406,0.1317054217682283,0.16026500046021308,0.06992874424890945,0.04566505345719873,0.04465988042248793,0.044715980025857374,0.044488825134487056,0.044535919708784524,0.044675138344711804,0.044789741645569085,0.045202483741035124,0.04608750943680781,0.048942402239160694,0.05211392581736041,0.05358439124939922,0.053877557031116664,0.05196013516055984,0.051798777458911795,0.05135986455787918,0.05138066980334245,0.05261102965713249,0.05304296737681415,0.053357382532210194,0.054463978375125115,0.056318360671719185,0.11697547804710594,1.1799762889903376,0.95980752259007,0.6862663824070405,0.3435350293197548,0.08541646145781932,-0.07086906577461603,-0.07986712212292135,-0.0792961543035589,-0.07859850693691735,-0.07732304726982166,-0.08097473883334498,-0.06256968635366356,-0.05627308700644821,-0.05766438137149892,-0.04138536602938431,-0.039470693393750395,-0.039291319924681066,-0.03829021318181633,-0.03935447091061665,-0.03856055567912131,-0.03820246978908558,-0.035334598117385714,-0.035770992715075126,-0.03558031171162811,-0.035129071385701545,-0.03539745118663851,-0.03478037532799903,-0.03464498151203896,-0.035118865031949296,-0.036610615738098276,-0.03530644543540104)
net_minHPD=c(-0.19255064197558008, -0.30154354778013565,-0.5555475078456173,0.1441992073430981,0.14445800164266287,-0.08833823813403024,-0.08175654710744037,-0.08251680093852001,-0.08187063667737622,-0.08233545705630106,-0.08175654710744037,-0.0856796545386457,0.04213998634032309,0.04289061116653513,0.04289061116653513,0.04289061116653513,0.04289061116653513,0.042629046509642804,0.04289061116653513,0.04120484392245577,0.03516890272320927,-0.03222668260455264,-0.04506013875648664,-0.0521820846736456,-0.05709529722253258,-0.058570750869030755,-0.05839786148039135,-0.05251597611108605,-0.05354247973044851,-0.050963363861170494,-0.04221026842524468,-0.03335176015379425,-0.02021167670261903,-0.017146656197717852,-0.01632587087149888,-0.01632587087149888,-0.016661930714315668,-0.017146656197717852,-0.036664127213103914,-0.028990586376609798,-0.02416768822509574,-0.028204641045599763,-0.03048195363268577,-0.020577883892945917,-0.004721075882117315,-0.08141010043861288,-0.0843052118100166,-0.07835634827801341,-0.08235904080432002,-0.07578153167132742,-0.07578153167132742,-0.08094146022760018,-0.07843811734365924,-0.07931492347605998,-0.07725662889867563,-0.08235904080432002,-0.08232038383266113,-0.08556529271181235,-0.09579583502735467,-0.097003073638885,-0.09785203108394161,-0.09785203108394161,-0.09102145149651591,-0.097003073638885,-0.09203634023392987,-0.09374766349579694,-0.09785203108394161,-0.0984793367822863,-0.1515177280778081,-3.0478211039983663,-4.832745501562117,-5.419913956101464,-5.904399885819441,-5.634599395365791,-4.777160605848166,-4.833951344378229,-4.67132524503118,-4.6020559788543265,-4.600714916346793,-4.369755499917035,-4.369755499917035,-4.299747189340396,-4.299747189340396,-4.172931652368307,-4.172931652368307,-4.28298406327861,-4.299747189340396,-4.303963135494251,-4.307354594941897,-4.307354594941897,-4.303963135494251,-4.307354594941897,-4.299747189340396,-4.307354594941897,-4.307354594941897,-4.303963135494251,-4.303963135494251,-4.303963135494251,-4.303963135494251,-4.307354594941897)
net_maxHPD=c(0.1201631351178436, 0.11714116154644014,0.008645723430597274,0.24571950124124844,0.24583611977667302,0.16803019874171965,-0.03207949587489309,-0.032946987247453596,-0.03236847611117544,-0.032870407790462436,-0.03204882875415968,-0.027804705767909277,0.11126251711675236,0.11144188305172814,0.11136157658292056,0.11136157658292056,0.11134454318872741,0.11136157658292056,0.1117806681815923,0.11136157658292056,0.11749900631162928,0.11126251711675236,0.10264790565388535,0.08629986485174963,0.010705856040940195,0.012173930102157796,0.01946297167274119,0.032598201487551395,0.03515487765962584,0.05186102362640421,0.06760793225240376,0.07042316806435692,0.07525211490048138,0.0751012443026298,0.07551079427544997,0.07540324845628246,0.07525211490048138,0.07579983578622657,0.11438736731446722,0.1634027572804453,0.18939073180885269,0.20979896363068407,0.2633848426966578,0.28139561294330656,0.2989680053970058,0.24822804805766618,0.17698999910126728,0.17698999910126728,0.17163413320324594,0.1770856970425978,0.17693110977430962,0.17157989334456278,0.17352810556612688,0.17163413320324594,0.17352810556612688,0.17558776502098705,0.1844105200171659,0.19066798637245533,0.19030005860241506,0.20087185380471678,0.20150751801726885,0.202686064896515,0.21106984115345853,0.2044279983270838,0.21106984115345853,0.21106984115345853,0.2121473663841632,0.2220696410808235,0.3322875538824688,6.853032185822294,6.4709975517647935,6.470142095808391,6.063242579623299,5.629238947768747,4.78228207599305,4.388556692581235,4.163961764930796,4.172955100195617,4.128720946300228,4.2984902164756065,4.172955100195617,4.128381015092633,3.9985081877679023,3.9996611820022534,3.9996611820022534,3.890953689896718,3.8768910336290325,3.8768910336290325,3.8768910336290325,3.8768910336290325,3.890953689896718,3.8768910336290325,3.890953689896718,3.8768910336290325,3.8768910336290325,3.8768910336290325,3.8768910336290325,3.8768910336290325,3.8768910336290325,3.8768910336290325)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-6.494839874401385, 7.538335404404524), xlim = c(-147.7878483103789,-0.0), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-0.7389392415518945, -2.2168177246556837,-3.694696207759473,-5.172574690863262,-6.65045317396705,-8.12833165707084,-9.606210140174628,-11.084088623278417,-12.561967106382205,-14.039845589485994,-15.517724072589784,-16.995602555693576,-18.473481038797363,-19.951359521901153,-21.42923800500494,-22.90711648810873,-24.38499497121252,-25.862873454316308,-27.340751937420098,-28.818630420523885,-30.296508903627675,-31.774387386731465,-33.25226586983525,-34.73014435293904,-36.20802283604283,-37.685901319146616,-39.1637798022504,-40.6416582853542,-42.119536768457984,-43.59741525156177,-45.075293734665564,-46.55317221776935,-48.03105070087314,-49.50892918397693,-50.98680766708072,-52.464686150184505,-53.9425646332883,-55.420443116392086,-56.89832159949587,-58.37620008259966,-59.85407856570345,-61.33195704880724,-62.80983553191103,-64.28771401501483,-65.76559249811862,-67.2434709812224,-68.7213494643262,-70.19922794742999,-71.67710643053377,-73.15498491363756,-74.63286339674134,-76.11074187984514,-77.58862036294893,-79.06649884605271,-80.5443773291565,-82.0222558122603,-83.50013429536408,-84.97801277846787,-86.45589126157167,-87.93376974467544,-89.41164822777924,-90.88952671088303,-92.36740519398681,-93.8452836770906,-95.3231621601944,-96.80104064329818,-98.27891912640197,-99.75679760950577,-101.23467609260955,-102.71255457571334,-104.19043305881713,-105.66831154192091,-107.14619002502471,-108.6240685081285,-110.10194699123228,-111.57982547433608,-113.05770395743987,-114.53558244054365,-116.01346092364744,-117.49133940675122,-118.96921788985502,-120.44709637295881,-121.92497485606259,-123.40285333916638,-124.88073182227018,-126.35861030537396,-127.83648878847777,-129.31436727158155,-130.79224575468533,-132.27012423778913,-133.7480027208929,-135.2258812039967,-136.7037596871005,-138.18163817020428,-139.65951665330806,-141.13739513641187,-142.61527361951565,-144.09315210261943,-145.5710305857232,-147.04890906882702)
rate=c(2.9538044135702646, 2.6349634679266924,1.8208770179451932,8.240639775801274,8.23921586497566,8.238560547846392,8.237866012900302,8.236759005221083,8.236096755864601,8.236178175681536,8.236072845452828,8.236728098300503,8.237335497202876,8.238454410246028,8.23872796747099,8.238988351133107,8.238660404610474,8.238888099982473,8.23899532779357,8.238707847751972,8.238057506657237,8.23648883360691,8.23745538862582,8.241851812985796,8.268006070363395,8.393201826031234,8.487186275806993,8.599511242083695,8.718226165952244,9.3850525826165,13.180313285038524,15.254525959660633,16.254729784452472,16.530109184835776,16.550585001242634,16.557256629290848,16.550356816633393,16.545251207988393,16.547694220730918,16.547759411968215,16.477830430033176,15.84009062534736,14.532695046793517,13.90872295854524,11.238831011785033,5.294154026821285,4.670059473695038,4.646988424856363,4.648326934011321,4.643708162665512,4.643940106347454,4.645018258718867,4.646292170869657,4.6435533591748985,4.638454308157845,4.634853430728426,4.62981913065892,4.6041018782650704,4.582527078302315,4.533452794980311,4.5268904937400425,4.522665267280693,4.521871006426088,4.542733345571535,4.548444143313282,4.5515527665160285,4.5508626796862215,4.5428976336485585,4.46511222313793,1.864512578508105,0.8389158184427427,0.5280431988976909,0.3772487785501436,0.2932513881028591,0.24349870160480475,0.23785424614434497,0.23429105103712788,0.2338497301042599,0.23341040661392973,0.23260261214400474,0.23225522412097568,0.23180970074166615,0.23083007795755942,0.23056261321907115,0.23055377710196995,0.23059806621860116,0.23063940765141602,0.23061515551138173,0.23067561496195343,0.23071105179275667,0.23088415595555742,0.23091293486798883,0.2309443361033896,0.23102158745076837,0.2310367475195336,0.23112431987178275,0.23112448048091527,0.2311153066241911,0.23114360837130338,0.23126678317171043)
minHPD=c(2.9538044135702646, 2.6349634679266924,1.8208770179451932,8.240639775801274,8.23921586497566,8.238560547846392,8.237866012900302,8.236759005221083,8.236096755864601,8.236178175681536,8.236072845452828,8.236728098300503,8.237335497202876,8.238454410246028,8.23872796747099,8.238988351133107,8.238660404610474,8.238888099982473,8.23899532779357,8.238707847751972,8.238057506657237,8.23648883360691,8.23745538862582,8.241851812985796,8.268006070363395,8.393201826031234,8.487186275806993,8.599511242083695,8.718226165952244,9.3850525826165,13.180313285038524,15.254525959660633,16.254729784452472,16.530109184835776,16.550585001242634,16.557256629290848,16.550356816633393,16.545251207988393,16.547694220730918,16.547759411968215,16.477830430033176,15.84009062534736,14.532695046793517,13.90872295854524,11.238831011785033,5.294154026821285,4.670059473695038,4.646988424856363,4.648326934011321,4.643708162665512,4.643940106347454,4.645018258718867,4.646292170869657,4.6435533591748985,4.638454308157845,4.634853430728426,4.62981913065892,4.6041018782650704,4.582527078302315,4.533452794980311,4.5268904937400425,4.522665267280693,4.521871006426088,4.542733345571535,4.548444143313282,4.5515527665160285,4.5508626796862215,4.5428976336485585,4.46511222313793,1.864512578508105,0.8389158184427427,0.5280431988976909,0.3772487785501436,0.2932513881028591,0.24349870160480475,0.23785424614434497,0.23429105103712788,0.2338497301042599,0.23341040661392973,0.23260261214400474,0.23225522412097568,0.23180970074166615,0.23083007795755942,0.23056261321907115,0.23055377710196995,0.23059806621860116,0.23063940765141602,0.23061515551138173,0.23067561496195343,0.23071105179275667,0.23088415595555742,0.23091293486798883,0.2309443361033896,0.23102158745076837,0.2310367475195336,0.23112431987178275,0.23112448048091527,0.2311153066241911,0.23114360837130338,0.23126678317171043)
maxHPD=c(2.9538044135702646, 2.6349634679266924,1.8208770179451932,8.240639775801274,8.23921586497566,8.238560547846392,8.237866012900302,8.236759005221083,8.236096755864601,8.236178175681536,8.236072845452828,8.236728098300503,8.237335497202876,8.238454410246028,8.23872796747099,8.238988351133107,8.238660404610474,8.238888099982473,8.23899532779357,8.238707847751972,8.238057506657237,8.23648883360691,8.23745538862582,8.241851812985796,8.268006070363395,8.393201826031234,8.487186275806993,8.599511242083695,8.718226165952244,9.3850525826165,13.180313285038524,15.254525959660633,16.254729784452472,16.530109184835776,16.550585001242634,16.557256629290848,16.550356816633393,16.545251207988393,16.547694220730918,16.547759411968215,16.477830430033176,15.84009062534736,14.532695046793517,13.90872295854524,11.238831011785033,5.294154026821285,4.670059473695038,4.646988424856363,4.648326934011321,4.643708162665512,4.643940106347454,4.645018258718867,4.646292170869657,4.6435533591748985,4.638454308157845,4.634853430728426,4.62981913065892,4.6041018782650704,4.582527078302315,4.533452794980311,4.5268904937400425,4.522665267280693,4.521871006426088,4.542733345571535,4.548444143313282,4.5515527665160285,4.5508626796862215,4.5428976336485585,4.46511222313793,1.864512578508105,0.8389158184427427,0.5280431988976909,0.3772487785501436,0.2932513881028591,0.24349870160480475,0.23785424614434497,0.23429105103712788,0.2338497301042599,0.23341040661392973,0.23260261214400474,0.23225522412097568,0.23180970074166615,0.23083007795755942,0.23056261321907115,0.23055377710196995,0.23059806621860116,0.23063940765141602,0.23061515551138173,0.23067561496195343,0.23071105179275667,0.23088415595555742,0.23091293486798883,0.2309443361033896,0.23102158745076837,0.2310367475195336,0.23112431987178275,0.23112448048091527,0.2311153066241911,0.23114360837130338,0.23126678317171043)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 18.212982292219934), xlim = c(-147.7878483103789,-0.0), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()